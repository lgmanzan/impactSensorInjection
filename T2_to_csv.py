# Script for the analysis of injection attacks on sensor-based continuous authentication for smartphones
# This script makes use of Sherlock dataset (http://bigdata.ise.bgu.ac.il/sherlock/#/)
# This script focuses on converting gyroscope and accelerometer data from Sherlock dataset to CSV
# AUTHORS: Lorena Gonzalez (lgmanzan at inf.uc3m.es), Jose Maria de Fuentes (jfuentes at inf.uc3m.es)
# Version: 2020-06-15
import csv

import os
import csv
import sys


dir = sys.argv[1]
dircsvT1 = dir + '/T2.csv'
dirOriginal = dir + '/T2.tsv'

file = file(dircsvT1, 'wb')

fieldnames = ['userid', 'uuid', 'version', 'timestamp', 'accelerometerstat_x_dc_fft', 'accelerometerstat_x_first_idx_fft', 'accelerometerstat_x_first_val_fft', 'accelerometerstat_x_fourth_idx_fft', 'accelerometerstat_x_fourth_val_fft', 'accelerometerstat_x_mean', 'accelerometerstat_x_mean_fft', 'accelerometerstat_x_median', 'accelerometerstat_x_median_fft', 'accelerometerstat_x_second_idx_fft', 'accelerometerstat_x_second_val_fft', 'accelerometerstat_x_third_idx_fft', 'accelerometerstat_x_third_val_fft', 'accelerometerstat_x_var', 'accelerometerstat_x_var_fft', 'accelerometerstat_y_dc_fft', 'accelerometerstat_y_first_idx_fft', 'accelerometerstat_y_first_val_fft', 'accelerometerstat_y_fourth_idx_fft', 'accelerometerstat_y_fourth_val_fft', 'accelerometerstat_y_mean', 'accelerometerstat_y_mean_fft', 'accelerometerstat_y_median', 'accelerometerstat_y_median_fft', 'accelerometerstat_y_second_idx_fft', 'accelerometerstat_y_second_val_fft', 'accelerometerstat_y_third_idx_fft', 'accelerometerstat_y_third_val_fft', 'accelerometerstat_y_var', 'accelerometerstat_y_var_fft', 'accelerometerstat_z_dc_fft', 'accelerometerstat_z_first_idx_fft', 'accelerometerstat_z_first_val_fft', 'accelerometerstat_z_fourth_idx_fft', 'accelerometerstat_z_fourth_val_fft', 'accelerometerstat_z_mean', 'accelerometerstat_z_mean_fft', 'accelerometerstat_z_median', 'accelerometerstat_z_median_fft', 'accelerometerstat_z_second_idx_fft', 'accelerometerstat_z_second_val_fft', 'accelerometerstat_z_third_idx_fft', 'accelerometerstat_z_third_val_fft', 'accelerometerstat_z_var', 'accelerometerstat_z_var_fft', 'accelerometerstat_cov_y_x', 'accelerometerstat_cov_z_x', 'accelerometerstat_cov_z_y', 'gyroscopestat_x_dc_fft', 'gyroscopestat_x_first_idx_fft', 'gyroscopestat_x_first_val_fft', 'gyroscopestat_x_fourth_idx_fft', 'gyroscopestat_x_fourth_val_fft', 'gyroscopestat_x_mean', 'gyroscopestat_x_mean_fft', 'gyroscopestat_x_median', 'gyroscopestat_x_median_fft', 'gyroscopestat_x_second_idx_fft', 'gyroscopestat_x_second_val_fft', 'gyroscopestat_x_third_idx_fft', 'gyroscopestat_x_third_val_fft', 'gyroscopestat_x_var', 'gyroscopestat_x_var_fft', 'gyroscopestat_y_dc_fft', 'gyroscopestat_y_first_idx_fft', 'gyroscopestat_y_first_val_fft', 'gyroscopestat_y_fourth_idx_fft', 'gyroscopestat_y_fourth_val_fft', 'gyroscopestat_y_mean', 'gyroscopestat_y_mean_fft', 'gyroscopestat_y_median', 'gyroscopestat_y_median_fft', 'gyroscopestat_y_second_idx_fft', 'gyroscopestat_y_second_val_fft', 'gyroscopestat_y_third_idx_fft', 'gyroscopestat_y_third_val_fft','gyroscopestat_y_third_val_fft','gyroscopestat_y_var','gyroscopestat_y_var_fft','gyroscopestat_z_dc_fft','gyroscopestat_z_first_idx_fft', 'gyroscopestat_z_first_val_fft', 'gyroscopestat_z_fourth_idx_fft', 'gyroscopestat_z_fourth_val_fft', 'gyroscopestat_z_mean', 'gyroscopestat_z_mean_fft', 'gyroscopestat_z_median', 'gyroscopestat_z_median_fft', 'gyroscopestat_z_second_idx_fft', 'gyroscopestat_z_second_val_fft', 'gyroscopestat_z_third_idx_fft', 'gyroscopestat_z_third_val_fft', 'gyroscopestat_z_var', 'gyroscopestat_z_var_fft', 'gyroscopestat_cov_y_x', 'gyroscopestat_cov_z_x', 'gyroscopestat_cov_z_y', 'magneticfield_x_dc_fft', 'magneticfield_x_first_idx_fft', 'magneticfield_x_first_val_fft', 'magneticfield_x_fourth_idx_fft', 'magneticfield_x_fourth_val_fft', 'magneticfield_x_mean', 'magneticfield_x_mean_fft', 'magneticfield_x_median', 'magneticfield_x_median_fft', 'magneticfield_x_second_idx_fft', 'magneticfield_x_second_val_fft', 'magneticfield_x_third_idx_fft', 'magneticfield_x_third_val_fft', 'magneticfield_x_var', 'magneticfield_x_var_fft', 'magneticfield_y_dc_fft', 'magneticfield_y_first_idx_fft', 'magneticfield_y_first_val_fft', 'magneticfield_y_fourth_idx_fft', 'magneticfield_y_fourth_val_fft', 'magneticfield_y_mean', 'magneticfield_y_mean_fft', 'magneticfield_y_median', 'magneticfield_y_median_fft', 'magneticfield_y_second_idx_fft', 'magneticfield_y_second_val_fft', 'magneticfield_y_third_idx_fft', 'magneticfield_y_third_val_fft', 'magneticfield_y_var', 'magneticfield_y_var_fft', 'magneticfield_z_dc_fft', 'magneticfield_z_first_idx_fft', 'magneticfield_z_first_val_fft', 'magneticfield_z_fourth_idx_fft', 'magneticfield_z_fourth_val_fft', 'magneticfield_z_mean', 'magneticfield_z_mean_fft', 'magneticfield_z_median', 'magneticfield_z_median_fft', 'magneticfield_z_second_idx_fft', 'magneticfield_z_second_val_fft', 'magneticfield_z_third_idx_fft', 'magneticfield_z_third_val_fft', 'magneticfield_z_var', 'magneticfield_z_var_fft', 'magneticfield_cov_y_x', 'magneticfield_cov_z_x', 'magneticfield_cov_z_y', 'pressure_dc_fft', 'pressure_first_idx_fft', 'pressure_first_val_fft', 'pressure_fourth_idx_fft', 'pressure_fourth_val_fft', 'pressure_mean', 'pressure_mean_fft', 'pressure_median', 'pressure_median_fft', 'pressure_second_idx_fft', 'pressure_second_val_fft', 'pressure_third_idx_fft', 'pressure_third_val_fft', 'pressure_var', 'pressure_var_fft', 'orientationprobe_azimuth_mean', 'orientationprobe_azimuth_median', 'orientationprobe_azimuth_middle_sample', 'orientationprobe_pitch_mean', 'orientationprobe_pitch_median', 'orientationprobe_pitch_middle_sample', 'orientationprobe_roll_mean', 'orientationprobe_roll_median', 'orientationprobe_roll_middle_sample', 'rotationvector_costhetaover2_mean', 'ro', 'rotationvector_costhetaover2_middle_sample', 'rotationvector_xsinthetaover2_mean', 'rotationvector_xsinthetaover2_median', 'rotationvector_xsinthetaover2_middle_sample', 'rotationvector_ysinthetaover2_mean', 'rotationvector_ysinthetaover2_middle_sample', 'rotationvector_zsinthetaover2_mean', 'rotationvector_zsinthetaover2_median', 'rotationvector_zsinthetaover2_middle_sample', 'linearacceleration_cov_y_x', 'linearacceleration_cov_z_x', 'linearacceleration_cov_z_y', 'linearacceleration_x_dc_fft', 'linearacceleration_x_first_idx_fft', 'linearacceleration_x_first_val_fft', 'linearacceleration_x_fourth_idx_fft', 'linearacceleration_x_fourth_val_fft', 'linearacceleration_x_mean', 'linearacceleration_x_mean_fft', 'linearacceleration_x_median', 'linearacceleration_x_median_fft', 'linearacceleration_x_second_idx_fft', 'linearacceleration_x_second_val_fft', 'linearacceleration_x_third_idx_fft', 'linearacceleration_x_third_val_fft', 'linearacceleration_x_var', 'linearacceleration_x_var_fft', 'linearacceleration_y_dc_fft', 'linearacceleration_y_first_idx_fft', 'linearacceleration_y_first_val_fft', 'linearacceleration_y_fourth_idx_fft', 'linearacceleration_y_fourth_val_fft', 'inearacceleration_y_mean', 'linearacceleration_y_mean_fft', 'linearacceleration_y_median', 'linearacceleration_y_median_fft', 'linearacceleration_y_second_idx_fft', 'linearacceleration_y_second_val_fft', 'linearacceleration_y_third_idx_fft', 'linearacceleration_y_third_val_fft', 'linearacceleration_y_var', 'linearacceleration_y_var_fft', 'linearacceleration_z_dc_fft', 'linearacceleration_z_first_idx_fft', 'linearacceleration_z_first_val_fft', 'linearacceleration_z_fourth_idx_fft', 'linearacceleration_z_fourth_val_fft', 'linearacceleration_z_mean', 'linearacceleration_z_mean_fft', 'linearacceleration_z_median', 'linearacceleration_z_median_fft', 'linearacceleration_z_second_idx_fft', 'linearacceleration_z_second_val_fft', 'linearacceleration_z_third_idx_fft', 'linearacceleration_z_third_val_fft', 'linearacceleration_z_var', 'linearacceleration_z_var_fft', 'gyroscopestat_x_middle_sample', 'gyroscopestat_y_middle_sample', 'gyroscopestat_z_middle_sample', 'magneticfield_x_middle_sample', 'magneticfield_y_middle_sample', 'magneticfield_z_middle_sample', 'pressure_middle_sample']
csv.writer(file).writerow(fieldnames)

csv.writer(file).writerows(csv.reader(open(dirOriginal), delimiter="\t"))

file.close()



